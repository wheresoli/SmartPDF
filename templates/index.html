<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>SimplyPDF - lightweight editor</title>
    <link rel="stylesheet" href="/static/style.css" />
    <!-- Load PDF.js: prefer local if present, else load CDN. -->
    {% if local_pdfjs %}
    <script src="/static/lib/pdf.js"></script>
    <script>window.PDFJS_WORKER_SRC = '/static/lib/pdf.worker.js';</script>
    {% else %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>window.PDFJS_WORKER_SRC = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';</script>
    {% endif %}
</head>

<body>
    <div id="toolbar">
        <input id="fileInput" type="file" accept="application/pdf" />
        <button id="btnPrev">◀</button>
        <input id="pageNum" type="number" min="1" value="1" style="width:60px" />
        <span id="pageCount">/ 0</span>
        <button id="btnNext">▶</button>
        <button id="btnText">Text</button>


        <button id="btnImage">Image</button>
        <button id="btnSignature">Signature</button>
        <button id="btnSave">Save to PDF</button>
        <span style="margin-left:12px"></span>
        <button id="btnDetectionsToggle">Show/Hide Detections</button>
        <button id="btnDetectionsRescan">Rescan Detections</button>
        <label style="margin-left:8px">Scale
            <input id="detectScale" type="number" min="3" max="8" step="1" value="5" style="width:50px" />
        </label>
    </div>

    <div id="viewerWrap">
        <div id="canvasContainer"></div>
    </div>

    <div id="signatureModal" class="modal">
        <div class="modal-content">
            <canvas id="sigCanvas" width="600" height="200" style="border:1px solid #ccc"></canvas>
            <div>
                <button id="sigClear">Clear</button>
                <button id="sigSave">Save</button>
                <button id="sigCancel">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        const filenameFromServer = {{ filename| tojson if filename is defined else 'null' }};
        const fileUrlFromServer = {{ file_url| tojson if file_url is defined else 'null' }};
    </script>
    <script src="/static/main.js"></script>
</body>

</html>